<div class="product-container">
  <!-- Yükleniyor durumu -->
  <div *ngIf="loading" class="loading-spinner">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Loading products...</p>
  </div>

  <!-- Hata durumu -->
  <div *ngIf="error" class="error-message">
    <mat-icon>error</mat-icon>
    {{ error }}
    <button mat-button color="primary" (click)="retryLoading()">
      <mat-icon>refresh</mat-icon>
      Try Again
    </button>
  </div>

  <!-- Ürün listesi -->
  <div *ngIf="!loading && !error" class="product-grid">
    <div *ngFor="let product of products; trackBy: trackByProductId"
         class="product-card mat-elevation-z2"
         [class.out-of-stock]="product.stock === 0">
      <div class="product-image">
        <img [src]="product.imageUrl || 'assets/placeholder.jpg'"
             [alt]="product.name"
             loading="lazy"
             (error)="handleImageError($event)">
      </div>

      <div class="product-info">
        <h3 class="product-title">{{ product.name }}</h3>
        <p class="product-price">{{ product.price | currency:'TRY':'symbol':'1.2-2' }}</p>

        <div class="stock-status">
          <mat-icon [color]="product.stock > 0 ? 'primary' : 'warn'">
            {{ product.stock > 0 ? 'check_circle' : 'cancel' }}
          </mat-icon>
          <span>{{ product.stock > 0 ? 'In Stock' : 'Out of Stock' }}</span>
        </div>

        <div class="product-actions">
          <a mat-button
             color="primary"
             [routerLink]="['/', product.id]"
             [attr.aria-label]="'View details of ' + product.name">
            <mat-icon>visibility</mat-icon>
            Details
          </a>

          <button mat-raised-button
                  color="accent"
                  (click)="addToCart(product)"
                  [disabled]="product.stock === 0"
                  [attr.aria-label]="'Add ' + product.name + ' to cart'">
            <mat-icon>add_shopping_cart</mat-icon>
            Add to Cart
          </button>
        </div>
      </div>
    </div>

    <!-- Ürün yoksa -->
    <div *ngIf="products.length === 0" class="no-products">
      <mat-icon>info</mat-icon>
      <p>No products available</p>
    </div>
  </div>
</div>
